<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Virtual Tour ‚Äì Dijk van een Wijf</title>
  
  <style>
    /* Full-screen background & center layout */
    html, body {
      margin: 0; padding: 0;
      width: 100%; height: 100%;
      background: url('background.jpg') center/cover no-repeat fixed;
      display: flex; align-items: center; justify-content: center;
      font-family: 'Circular Std', sans-serif;
      position: relative; overflow: hidden;
    }
    
    /* Wordmark top-right */
    #wordmark {
      position: fixed; top: 20px; right: 20px;
      width: 200px; opacity: 0.9; z-index: 20;
    }

    /* Container for widget + mute button */
    #mainContent {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
      z-index: 10;
    }

    /* Start Tour buttons at bottom-center */
    #startOptions {
      position: absolute; bottom: 4rem; left: 50%; transform: translateX(-50%);
      display: flex; flex-direction: column; align-items: center; gap: 1rem;
      z-index: 20;
    }
    #startOptions button {
      width: 80vw; max-width: 12rem;
      padding: 1em;
      background: rgba(255,255,255,0.6);
      color: #1D1D1B;
      border: 2px solid #EE7440;
      border-radius: 32px;
      font: 700 1rem/1.2 'Circular Std', sans-serif;
      text-align: center;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }
    #startOptions button:hover {
      background: rgba(238,116,64,0.8);
      transform: scale(1.05);
    }
    #startOptions.hidden { display: none; }

    /* Widget container centered */
    #widgetContainer {
      width: 90vw; max-width: 600px;
    }

    /* Mute button like tour button, placed under widget */
    #muteBar {
      width: 90vw; max-width: 600px;
      padding: 1em;
      background: rgba(255,255,255,0.6);
      color: #1D1D1B;
      border: 2px solid #EE7440;
      border-radius: 32px;
      font: 700 1rem/1.2 'Circular Std', sans-serif;
      text-align: center;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }
    #muteBar:hover {
      background: rgba(238,116,64,0.8);
      transform: scale(1.05);
    }
    #muteBar.hidden { display: none; }

    /* Responsive adjustments */
    @media (max-width: 600px) {
      #startOptions { bottom: 3rem; }
      #startOptions button { width: 90vw; font-size: 0.9rem; }
      #widgetContainer { width: 95vw; }
      #muteBar { width: 95vw; font-size: 0.9rem; padding: 0.8em; }
    }
  </style>
</head>
<body>
  <img id="wordmark" src="Dijk_van_een_Wijf_Logo.png" alt="Dijk van een Wijf">

  <!-- Start Tour Buttons -->
  <div id="startOptions">
    <button data-agent="agent_01jykbe73efcma2nva2xmhzqfh">Start Tour<br>English üá¨üáß</button>
    <button data-agent="agent_01jxj6kx8cezesfxrsdxcjxx30">Start Tour<br>Dutch üá≥üá±</button>
    <button data-agent="agent_FRIESIAN_ID">Start Tour<br>Friesian üêö</button>
  </div>

  <!-- Main Content: widget + mute -->
  <div id="mainContent">
    <div id="widgetContainer"></div>
    <button id="muteBar" class="hidden">Mute Music</button>
  </div>

  <!-- Background Audio -->
  <audio id="bgAudio" src="ocean.mp3" loop preload="auto"></audio>

  <!-- Embed Script -->
  <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async></script>
  <script>
    const startOptions    = document.getElementById('startOptions');
    const muteBar         = document.getElementById('muteBar');
    const bgAudio         = document.getElementById('bgAudio');
    const widgetContainer = document.getElementById('widgetContainer');

    function enhanceWidget(alpha=0.6) {
      const iv = setInterval(()=>{
        const iframe = document.querySelector('iframe');
        if(!iframe) return;
        try {
          const doc = iframe.contentDocument||iframe.contentWindow.document;
          const pane = doc.querySelector('[class*="Container"]');
          const btn = doc.querySelector('button');
          if(pane) pane.style.backdropFilter='blur(8px)', pane.style.background=`rgba(255,255,255,${alpha})`;
          if(btn && btn.innerText.toLowerCase().includes('begin')) btn.click(), clearInterval(iv);
        }catch{};
      },200);
    }

    startOptions.querySelectorAll('button').forEach(b=>{
      b.addEventListener('click',()=>{
        bgAudio.play().catch(()=>{});
        startOptions.classList.add('hidden');
        widgetContainer.innerHTML = `<elevenlabs-convai agent-id="${b.dataset.agent}"></elevenlabs-convai>`;
        muteBar.classList.remove('hidden');
        enhanceWidget();
      });
    });

    muteBar.addEventListener('click',()=>{
      bgAudio.muted = !bgAudio.muted;
      muteBar.textContent = bgAudio.muted? 'Unmute Music':'Mute Music';
    });
  </script>
</body>
</html>
